<!DOCTYPE html>
<html>
  <head>
    <script src="https://aframe.io/releases/1.0.4/aframe.js"></script>
    <script src="https://rawgit.com/rdub80/aframe-gui/master/dist/aframe-gui.js"></script>
    <script src="https://unpkg.com/aframe-input-mapping-component/dist/aframe-input-mapping-component.min.js"></script>
    <script src="https://static.robotwebtools.org/EventEmitter2/current/eventemitter2.js"></script>
    <script src="https://static.robotwebtools.org/roslibjs/current/roslib.js"></script>

    <script src="js/ros3d.js"></script>
    <script src="js/aframe-navigation-controls.js"></script>
    <script src="js/aframeros.js"></script>
    <script src="js/mappings.js"></script>
    <script src="js/robotcontrol.js"></script>
    <script src="js/side-controls.js"></script>

    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Abel"/>
    <link rel="stylesheet" href="index.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
    <title>MarsViz</title>
  </head>

  <body onload="init_env_after_seconds(1)">
    <a-scene
      inspector
      tap-place
      id="main"
      fog="type: linear; color: #C49452; near: 10; far: 100;"
    >
      <a-assets>
        <a-asset-item id="terrain" src="terrain_export_1.gltf"></a-asset-item>
      </a-assets>

      <a-sky color="#CCC299" scale="1 1 1"></a-sky>
      <a-entity light="type: ambient; color: #CCC299"></a-entity>
      <a-entity
        light="type: directional; color: #FFF; intensity: 1"
        position="-0.5 1 1"
      ></a-entity>
      <a-entity
        id="worldterrain"
        gltf-model="#terrain"
        position="0 0 0"
        rotation="0 0 0"
        scale="1 1 1"
        shadow="receive: false"
        class="cantap"
      ></a-entity>

      <a-entity id="rig" position="0 -0.5 5.1">
        <a-entity
          id="camera"
          camera="far: 4000;"
          look-controls
          wasd-controls="acceleration:100; fly:true"
          position="0 0 0"
          raycaster="objects: .cantap"
          cursor="
            fuse: false;
            rayOrigin: mouse;"
        >
        </a-entity>
        <a-entity
          id="leftHand"
          navigation-controls="type: line; cameraRig: #rig; hitCylinderColor: #7DF9FF; curveHitColor: #7DF9FF; robotNav: true;
                startEvents: navigationstart; endEvents: navigationend; collisionEntities: #worldterrain; maxLength: 50;"
          raycaster="objects: [gui-interactable]"
          laser-controls="hand: left;"
        >
        </a-entity>
        <a-entity
          id="rightHand"
          navigation-controls="type: line; cameraRig: #rig;
                startEvents: navigationstart; endEvents: navigationend; collisionEntities: #worldterrain; maxLength: 50;"
          raycaster="objects: [gui-interactable]"
          laser-controls="hand: right;"
        >
        </a-entity>
      </a-entity>

      <a-entity position="0 0 0" rotation="-90 0 0" id="robot-element-parent">
      </a-entity>
    </a-scene>
    <div class="sidenav">
        <h1>M A R S V I Z</h1>
        <p>Status: <span id="status" style="color:rgb(255, 147, 47)">Connecting...</span></p>
            <div class="boxes">
                <div class="controlbox">
                    <h2>Navigation</h2>
                        <div class="controlinner">
                            Teleoperation status: <span id="tele_state">OK</span>
                            <table>
                                <tbody>
                                <tr>
                                <td><button id="nw" onmousedown="teleop([1,0,0,0,0,1])" onmouseup="telestop()"><i class="material-icons md-18">north_west</i></button></td>
                                <td><button id="n" onmousedown="teleop([1,0,0,0,0,0])" onmouseup="telestop()"><i class="material-icons md-18">north</i></button></td>
                                <td><button id="ne" onmousedown="teleop([1,0,0,0,0,-1])" onmouseup="telestop()"><i class="material-icons md-18">north_east</i></button></td>
                                </tr>
                                <tr>
                                <td><button onmousedown="teleop([0,0,0,0,0,1])" onmouseup="telestop()"><i class="material-icons md-18">west</i></button></td>
                                <td><button onmousedown="teleop([0,0,0,0,0,0])" onmouseup="telestop()"><i class="material-icons md-18">stop</i></button></button></td>
                                <td><button onmousedown="teleop([0,0,0,0,0,-1])" onmouseup="telestop()"><i class="material-icons md-18">east</i></button></td>
                                </tr>
                                <tr>
                                <td><button id="sw" onmousedown="teleop([-1,0,0,0,0,1])" onmouseup="telestop()"><i class="material-icons md-18">south_west</i></button></td>
                                <td><button id="s" onmousedown="teleop([-1,0,0,0,0,0])" onmouseup="telestop()"><i class="material-icons md-18">south</i></button></td>
                                <td><button id="se" onmousedown="teleop([-1,0,0,0,0,-1])" onmouseup="telestop()"><i class="material-icons md-18">south_east</i></button></td>
                                </tr>
                                </tbody>
                            </table>
                            Speed multiplier: <span id="speed_state">1.0</span>
                            <table>
                                <tbody>
                                <tr>
                                <td><button onclick="slowDown()">Slow Down</button></td>
                                <td><button onclick="speedUp()">Speed Up</button></td>
                                </tr>
                            </tbody>
                            </table>
                            Auto nav status: <span id="nav_state">Waiting</span>
                            <table><tbody><tr><td><button onclick="pickMode()"><span id="send_button">Send Nav Goal</span></button></td></tr></tbody></table>
                        </div>
                </div>
                <div class="controlbox">
                    <h2>Mast (<span id="mast_state"></span>)</h2>
                    <div class="controlinner">
                        <table><tbody><tr><td><button id="mast_button" onclick="mast()">Raise/Lower Mast</button></td></tr></tbody></table>
                        <table>
                            <tbody>
                            <tr>
                            <td></td>
                            <td><button id="mu" onmousedown="mastClick('up')" onmouseup="mastStop()"><i class="material-icons md-18">north</i></button></td>
                            <td></td>
                            </tr>
                            <tr>
                            <td><button id="ml" onmousedown="mastClick('left')" onmouseup="mastStop()"><i class="material-icons md-18">west</i></button></td>
                            <td><button id="md" onmousedown="mastClick('down')" onmouseup="mastStop()"><i class="material-icons md-18">south</i></button></td>
                            <td><button id="mr" onmousedown="mastClick('right')" onmouseup="mastStop()"><i class="material-icons md-18">east</i></button></td>
                            </tr>
                            </tbody>
                        </table>
                        <table><tbody><tr><td><button id="panorama_button" onclick="panorama()"><span id="panorama_button_text">Take Panorama</span></button></td></tr></tbody></table>
                        Panorama status: <span id="panorama_status">Inactive</span>
                    </div>
                </div>
                <div class="controlbox">
                    <h2>Arm (<span id="arm_state"></span>)</h2>
                    <div class="controlinner">
                        <table><tbody><tr><td><button onclick="arm()">Open/Close Arm</button></td></tr></tbody></table>
                        <table>
                            <tbody>
                              <tr>
                                <td>Azimuth</td>
                                <td><input type="range" min="1" max="100" value="1" class="slider" id="joint1" oninput="armSet(this.id, this.value)"></td>
                              </tr>
                              <tr>
                                <td>Elevation</td>
                                <td><input type="range" min="1" max="100" value="1" class="slider" id="joint2" oninput="armSet(this.id, this.value)"></td>
                              </tr>
                              <tr>
                                <td>Elbow</td>
                                <td><input type="range" min="-100" max="100" value="0" class="slider" id="joint3" oninput="armSet(this.id, this.value)"></td>
                              </tr>
                              <tr>
                                <td>Wrist</td>
                                <td><input type="range" min="-100" max="100" value="0" class="slider" id="joint4" oninput="armSet(this.id, this.value)"></td>
                              </tr>
                              <tr>
                                <td>Tools</td>
                                <td><input type="range" min="-100" max="100" value="0" class="slider" id="effector" oninput="armSet(this.id, this.value)"></td>
                              </tr>
                            </tbody>
                          </table>
                    </div>
                </div>
            </div>
    </div>

  </body>
</html>
